<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="author" content="F U M">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <script async src="https://www.googletagmanager.com/gtag/js?id=G-B89KY0993B"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag() { dataLayer.push(arguments); }
        gtag('js', new Date());
        gtag('config', 'G-B89KY0993B');
    </script>

    <link rel="icon" type="image/x-icon" href="../../Asset/Image/favicon.ico">
    <link rel="apple-touch-icon" sizes="180x180" href="../../Asset/Image/Icon_1_2.jpg">
    <link href="https://fonts.googleapis.com/css2?family=Space+Mono:wght@400;700&family=Zen+Kaku+Gothic+New:wght@400;500;700&display=swap" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/vuetify@2.x/dist/vuetify.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/@mdi/font/css/materialdesignicons.min.css" rel="stylesheet">
    <link href="../../Asset/CSS/Common.css?v=1.0" rel="stylesheet" />

    <title>Setting</title>

    <style>
        html {
            user-select: auto;
        }
    </style>
</head>

<body>
    <v-app id="App">
        <template>

            <main-system-bar :drawer="Drawer" @change-drawer="ChangeDrawer">Setting</main-system-bar>
            <main-navigation :drawer="Drawer" @change-drawer="ChangeDrawer"></main-navigation>

            <v-main id="Main">
                <transition name="Fade_Page">
                    <v-container v-show="Ready_Page" fluid class="pa-5">

                        <v-row justify="center">

                            <v-col cols="12" md="8">
                                
                                <v-card class="mb-4 sound-card">
                                    <v-card-title class="text-h5 font-weight-bold py-3 d-flex justify-space-between">
                                        <span><v-icon left>mdi-music</v-icon>Sound</span>
                                        <v-btn icon @click="toggleCard('sound')">
                                            <v-icon>{{ soundExpanded ? 'mdi-chevron-up' : 'mdi-chevron-down' }}</v-icon>
                                        </v-btn>
                                    </v-card-title>
                                    <v-expand-transition>
                                        <v-card-text v-show="soundExpanded" class="pa-5">
                                            
                                            <!-- BGM選択 -->
                                            <div class="mb-6">
                                                <v-subheader class="px-0 font-weight-bold">
                                                    <v-icon left>mdi-playlist-music</v-icon>
                                                    BGM Selection
                                                </v-subheader>
                                                <v-select
                                                    v-model="settings.bgm"
                                                    :items="bgmOptions"
                                                    outlined
                                                    dense
                                                    @change="saveSettings"
                                                ></v-select>
                                            </div>

                                            <!-- BGMボリューム -->
                                            <div class="mb-6">
                                                <v-subheader class="px-0 font-weight-bold">
                                                    <v-icon left>mdi-volume-high</v-icon>
                                                    BGM Volume: {{ settings.bgmVolume }}%
                                                </v-subheader>
                                                <v-slider
                                                    v-model="settings.bgmVolume"
                                                    min="0"
                                                    max="100"
                                                    step="5"
                                                    thumb-label
                                                    @change="saveSettings"
                                                ></v-slider>
                                            </div>

                                            <!-- SEボリューム -->
                                            <div class="mb-4">
                                                <v-subheader class="px-0 font-weight-bold">
                                                    <v-icon left>mdi-volume-medium</v-icon>
                                                    SE Volume: {{ settings.seVolume }}%
                                                </v-subheader>
                                                <v-slider
                                                    v-model="settings.seVolume"
                                                    min="0"
                                                    max="100"
                                                    step="5"
                                                    thumb-label
                                                    @change="saveSettings"
                                                ></v-slider>
                                            </div>

                                            <v-alert
                                                type="success"
                                                dense
                                                text
                                                class="mt-4"
                                                v-if="soundSaved"
                                            >
                                                Settings saved successfully!
                                            </v-alert>

                                        </v-card-text>
                                    </v-expand-transition>
                                </v-card>

                                <v-card class="mb-4 color-card">
                                    <v-card-title class="text-h5 font-weight-bold py-3 d-flex justify-space-between">
                                        <span><v-icon left>mdi-palette</v-icon>Color</span>
                                        <v-btn icon @click="toggleCard('color')">
                                            <v-icon>{{ colorExpanded ? 'mdi-chevron-up' : 'mdi-chevron-down' }}</v-icon>
                                        </v-btn>
                                    </v-card-title>
                                    <v-expand-transition>
                                        <v-card-text v-show="colorExpanded" class="pa-5">
                                            
                                            <!-- メインカラー(背景色) -->
                                            <div class="mb-6">
                                                <v-subheader class="px-0 font-weight-bold">
                                                    <v-icon left>mdi-format-color-fill</v-icon>
                                                    Main Color (Background)
                                                </v-subheader>
                                                <v-row align="center">
                                                    <v-col cols="12" sm="8">
                                                        <v-text-field
                                                            v-model="settings.mainColor"
                                                            outlined
                                                            dense
                                                            placeholder="#FFFFFF"
                                                            @change="saveSettings"
                                                        ></v-text-field>
                                                    </v-col>
                                                    <v-col cols="12" sm="4">
                                                        <input 
                                                            type="color" 
                                                            v-model="settings.mainColor"
                                                            @change="saveSettings"
                                                            style="width: 100%; height: 40px; border-radius: 4px; border: 1px solid #ccc; cursor: pointer;"
                                                        >
                                                    </v-col>
                                                </v-row>
                                            </div>

                                            <!-- サブカラー -->
                                            <div class="mb-4">
                                                <v-subheader class="px-0 font-weight-bold">
                                                    <v-icon left>mdi-palette-advanced</v-icon>
                                                    Sub Color
                                                </v-subheader>
                                                <v-row align="center">
                                                    <v-col cols="12" sm="8">
                                                        <v-text-field
                                                            v-model="settings.subColor"
                                                            outlined
                                                            dense
                                                            placeholder="#000000"
                                                            @change="saveSettings"
                                                        ></v-text-field>
                                                    </v-col>
                                                    <v-col cols="12" sm="4">
                                                        <input 
                                                            type="color" 
                                                            v-model="settings.subColor"
                                                            @change="saveSettings"
                                                            style="width: 100%; height: 40px; border-radius: 4px; border: 1px solid #ccc; cursor: pointer;"
                                                        >
                                                    </v-col>
                                                </v-row>
                                            </div>

                                            <!-- プレビュー -->
                                            <div class="mb-4">
                                                <v-subheader class="px-0 font-weight-bold">
                                                    <v-icon left>mdi-eye</v-icon>
                                                    Preview
                                                </v-subheader>
                                                <div 
                                                    :style="{
                                                        backgroundColor: settings.mainColor,
                                                        color: settings.subColor,
                                                        padding: '20px',
                                                        borderRadius: '8px',
                                                        border: '2px solid #ddd',
                                                        textAlign: 'center'
                                                    }"
                                                >
                                                    <h3>Sample Text</h3>
                                                    <p>This is how your colors will look together.</p>
                                                </div>
                                            </div>

                                            <v-alert
                                                type="success"
                                                dense
                                                text
                                                class="mt-4"
                                                v-if="colorSaved"
                                            >
                                                Settings saved successfully!
                                            </v-alert>

                                        </v-card-text>
                                    </v-expand-transition>
                                </v-card>

                            </v-col>
                        </v-row>

                    </v-container>
                </transition>
            </v-main>

            <main-footer></main-footer>
        </template>
    </v-app>

    <style>
        .profile-card,
        .hobby-card,
        .life-journey-card,
        .job-offerings-card,
        .sound-card,
        .color-card {
            border-radius: 15px;
            overflow: hidden;
            transition: all 0.3s ease-in-out;
        }

        .profile-avatar {
            border: 5px solid white;
            box-shadow: 0 0 15px rgba(0, 0, 0, 0.1);
        }

        .v-timeline-item__body {
            padding-left: 15px;
        }

        .job-offerings-card .v-list-item__title {
            white-space: normal;
            overflow: visible;
            text-overflow: clip;
        }

        .subtitle-1 {
            margin-bottom: 0 !important;
        }
    </style>

    <script src="https://cdn.jsdelivr.net/npm/vue@2.x/dist/vue.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/vuetify@2.x/dist/vuetify.js"></script>
    <script src="https://code.jquery.com/jquery-3.3.1.js"></script>
    <script src="../../Asset/Javascript/Common.js?v=1.03"></script>


    <script>
        new Vue({
            el: '#App',
            vuetify: new Vuetify(),
            mixins: [window.Mixins_Common],
            data: {
                soundExpanded: false,
                colorExpanded: false,
                soundSaved: false,
                colorSaved: false,
                
                // BGMオプション
                bgmOptions: [
                    { text: 'None', value: 'none' },
                    { text: 'Calm Piano', value: 'calm_piano' },
                    { text: 'Nature Sounds', value: 'nature' },
                    { text: 'Lo-fi Beats', value: 'lofi' },
                    { text: 'Classical', value: 'classical' },
                    { text: 'Ambient', value: 'ambient' },
                ],

                // 設定データ
                settings: {
                    bgm: 'none',
                    bgmVolume: 50,
                    seVolume: 70,
                    mainColor: '#FFFFFF',
                    subColor: '#000000',
                },
            },
            
            mounted() {
                // ページ読み込み時に設定を復元
                this.loadSettings();
            },

            methods: {
                toggleCard(card) {
                    this[card + 'Expanded'] = !this[card + 'Expanded'];
                },

                // 設定を保存
                saveSettings() {
                    try {
                        localStorage.setItem('appSettings', JSON.stringify(this.settings));
                        
                        // 保存成功メッセージを表示
                        this.soundSaved = true;
                        this.colorSaved = true;
                        
                        // 2秒後にメッセージを非表示
                        setTimeout(() => {
                            this.soundSaved = false;
                            this.colorSaved = false;
                        }, 2000);
                        
                        console.log('Settings saved:', this.settings);
                    } catch (error) {
                        console.error('Failed to save settings:', error);
                        alert('Failed to save settings. Please try again.');
                    }
                },

                // 設定を読み込み
                loadSettings() {
                    try {
                        const saved = localStorage.getItem('appSettings');
                        if (saved) {
                            const parsedSettings = JSON.parse(saved);
                            // 既存の設定とマージ(新しい設定項目が追加された場合に対応)
                            this.settings = Object.assign({}, this.settings, parsedSettings);
                            console.log('Settings loaded:', this.settings);
                        }
                    } catch (error) {
                        console.error('Failed to load settings:', error);
                    }
                },
            }
        })
    </script>
</body>

</html>