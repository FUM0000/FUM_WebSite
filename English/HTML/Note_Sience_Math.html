<html>

<head>
  <meta charset="UTF-8">
  <meta name="author" content="F U M">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="Cache-Control" content="no-store, no-cache, must-revalidate, max-age=0">
  <meta http-equiv="Pragma" content="no-cache">
  <meta http-equiv="Expires" content="0">

  <script async src="https://www.googletagmanager.com/gtag/js?id=G-B89KY0993B"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag() { dataLayer.push(arguments); }
    gtag('js', new Date());
    gtag('config', 'G-B89KY0993B');
  </script>

  <link rel="icon" type="image/x-icon" href="../../Asset/Image/favicon.ico">
  <link rel="apple-touch-icon" sizes="180x180" href="../../Asset/Image/Icon_1_2.jpg">
  <link
    href="https://fonts.googleapis.com/css2?family=Space+Mono:wght@400;700&family=Zen+Kaku+Gothic+New:wght@400;500;700&display=swap"
    rel="stylesheet">

  <link href="https://cdn.jsdelivr.net/npm/vuetify@2.x/dist/vuetify.min.css" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/@mdi/font/css/materialdesignicons.min.css" rel="stylesheet">
  <link href="../../Asset/CSS/Common.css?v=1.0" rel="stylesheet" />
  <link href="../../Asset/CSS/Learning.css" rel="stylesheet" />

  <title>Math</title>

  <style>
    .code-block pre {
      background-color: #f5f5f5;
      border: 1px solid #ddd;
      border-radius: 4px;
      padding: 1em;
      overflow-x: auto;
      font-size: 0.85em;
      white-space: pre-wrap;
      word-wrap: break-word;
    }

    .code-block code {
      color: #333;
    }
  </style>
</head>

<body>
  <v-app id="App" v-cloak>
    <template>
      <main-system-bar :drawer="Drawer" @change-drawer="ChangeDrawer">Note > Sience > Math</main-system-bar>

      <v-main id="Main">
        <transition name="Fade_Page">
          <v-container v-show="Ready_Page" fluid fill-height class="pa-5" style="display: flex; align-content: center;">
            <v-row justify="center">
              <v-col xs="12" md="6">
                <v-card class="mt-6">
                  <v-card-title class="content-text">数学</v-card-title>
                  <v-card-text>
                    <v-text-field v-model="searchQuery" label="数学のトピックを検索" prepend-inner-icon="mdi-magnify" clearable
                      outlined dense class="mb-4" @input="filterTreeview"></v-text-field>

                    <v-stepper v-model="Count_Step_1">
                      <v-stepper-header>
                        <v-stepper-step :complete="Count_Step_1 > 1" step="1"
                          @click="Count_Step_1 = 1"></v-stepper-step>
                        <v-divider></v-divider>
                        <v-stepper-step :complete="Count_Step_2 > 2" step="2"
                          @click="Count_Step_2 = 2"></v-stepper-step>
                        <v-divider></v-divider>
                      </v-stepper-header>

                      <v-stepper-items>
                        <v-stepper-content step="1">
                          <v-card class="mb-12">
                            <v-card-text>
                              <v-card-title class="text-subtitle-2 font-weight-bold">暗算テクニック</v-card-title>
                              <v-treeview :items="filteredMentalArithmetic" item-key="name" activatable open-on-click
                                dense :open.sync="openNodesMentalArithmetic"
                                @update:open="updateOpenNodesMentalArithmetic">
                                <template v-slot:label="{ item }">
                                  <span :class="{ 'search-highlight': item.matches }">{{ item.name }}</span>
                                </template>
                              </v-treeview>
                            </v-card-text>
                          </v-card>
                          <div class="button-container">
                            <v-btn color="primary" @click="Count_Step_1 = 2">次へ</v-btn>
                          </div>
                        </v-stepper-content>
                      </v-stepper-items>
                      <v-stepper-items>
                        <v-stepper-content step="2">
                          <v-card class="mb-12">
                            <v-card-text>
                              <v-card-title class="text-subtitle-2 font-weight-bold">素数探索</v-card-title>
                              <v-treeview :items="filteredPrimeNumberSearch" item-key="name" activatable open-on-click
                                dense :open.sync="openNodesPrimeNumberSearch"
                                @update:open="updateOpenNodesPrimeNumberSearch">
                                <template v-slot:label="{ item }">
                                  <span :class="{ 'search-highlight': item.matches }">{{ item.name }}</span>
                                </template>
                              </v-treeview>
                            </v-card-text>
                          </v-card>
                          <div class="button-container">
                            <v-btn color="primary" @click="Count_Step_1 = 2">次へ</v-btn>
                          </div>
                        </v-stepper-content>
                      </v-stepper-items>
                    </v-stepper>
                  </v-card-text>
                </v-card>
              </v-col>
            </v-row>
          </v-container>
        </transition>
      </v-main>

      <main-navigation :drawer="Drawer" @change-drawer="ChangeDrawer"></main-navigation>
      <main-footer></main-footer>
    </template>
  </v-app>

  <script src="https://cdn.jsdelivr.net/npm/vue@2.x/dist/vue.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/vuetify@2.x/dist/vuetify.js"></script>
  <script src="https://code.jquery.com/jquery-3.3.1.js"></script>
  <script src="../../Asset/Javascript/Common.js?v=1.03"></script>

  <script>
    new Vue({
      el: '#App',
      vuetify: new Vuetify(),
      mixins: [window.Mixins_Common],
      data: {
        Count_Step_1: 1,
        dialog: false,
        searchQuery: '',
        filteredMentalArithmetic: [],
        filteredPrimeNumberSearch: [],
        openNodesMentalArithmetic: [],
        openNodesPrimeNumberSearch: [],
        MentalArithmetic: [
          {
            "name": "5 × n",
            "children": [
              { "name": "説明：5 × n = (n ÷ 2) × 10" },
              { "name": "例　：5 × 7 = (7 ÷ 2) × 10 = 35" }
            ]
          },
          {
            "name": "11 × AB(2d)",
            "children": [
              { "name": "説明：11 × AB = 'A' + '(A+B)' + 'B'" },
              { "name": "例　：11 × 23 = '2' + '(2+3)' + '3' = 253" }
            ]
          },
          {
            "name": "9 × n",
            "children": [
              { "name": "説明：9 × n = 10 × n − n" },
              { "name": "例　：9 × 7 = 10 × 7 − 7 = 70 − 7 = 63" }
            ]
          },
          {
            "name": "(10 + n)²",
            "children": [
              { "name": "説明：(10 + n)² = 100 + 20 × n + n²" },
              { "name": "例　：(10 + 3)² = 100 + 20 × 3 + 3² = 100 + 60 + 9 = 169" }
            ]
          },
          {
            "name": "中心差平方(平均の平方が計算しやすい場合)",
            "children": [
              { "name": "変数：x = (a + b) ÷ 2, d = x - a(a < b)" },
              { "name": "説明：a  × b   = (x   - d) × (x   + d) = x²   - d²" },
              { "name": "例　：98 × 102 = (100 - 2) × (100 + 2) = 100² − 2² = 9996" }
            ]
          },
          {
            "name": "分解計算(因数分解)",
            "children": [
              { "name": "説明：数を因数分解して簡略化" },
              { "name": "例　：25 × 16 = 25 × 4 × 4 = 400" }
            ]
          },
          {
            "name": "分解計算(分配法則)",
            "children": [
              { "name": "説明：大きな数は桁ごとに分けて分配法則" },
              { "name": "例　：23 × 16 = (20 + 3)(10 + 6) = 200 + 140 + 30 + 18 = 388" }
            ]
          },
          {
            "name": "段階計算（累乗利用）",
            "children": [
              { "name": "説明：片方の数を平方や立方の因数に分解して、もう片方を掛けながら段階的に計算する" },
              { "name": "例　： 7 × 16 → 7 × 2 = 14 → 14 × 2 = 28 → 28 × 2 = 56 → 56 × 2 = 112" },
              { "name": "例　： 5 × 27 → 5 × 3 = 15 → 15 × 3 = 45 → 45 × 3 = 135" },
            ]
          },
        ],
        PrimeNumberSearch: [
          {
            "name": "試し割り",
            "children": [
              { "name": "説明：√nの整数部までnを2以外の偶数を除き奇数で割り切れるか調べていく" },
              { "name": "例　：29は2,3,5で割り切れないので素数" },
            ]
          },
        ],
      },
      created() {
        this.filteredMentalArithmetic = JSON.parse(JSON.stringify(this.MentalArithmetic));
      },
      methods: {
        collectAllNodeIds(items) {
          const ids = [];
          const collect = (nodes) => {
            nodes.forEach((node) => {
              ids.push(node.name);
              if (node.children) {
                collect(node.children);
              }
            });
          };
          collect(items);
          return ids;
        },
        updateOpenNodesMentalArithmetic(newOpen) {
          this.openNodesMentalArithmetic = newOpen;
        },
        filterTreeview() {
          const query = this.searchQuery ? this.searchQuery.toLowerCase().trim() : '';
          if (!query) {
            this.filteredMentalArithmetic = JSON.parse(JSON.stringify(this.MentalArithmetic));
            this.openNodesMentalArithmetic = [];
            return;
          }

          const filterTree = (items) => {
            return items.reduce((acc, item) => {
              const itemCopy = { ...item };
              const matches = item.name.toLowerCase().includes(query);

              if (item.children) {
                itemCopy.children = filterTree(item.children);
                if (itemCopy.children.length > 0 || matches) {
                  itemCopy.matches = matches;
                  acc.push(itemCopy);
                }
              } else if (matches) {
                itemCopy.matches = true;
                acc.push(itemCopy);
              }
              return acc;
            }, []);
          };

          this.filteredMentalArithmetic = filterTree(JSON.parse(JSON.stringify(this.MentalArithmetic)));
          this.openNodesMentalArithmetic = this.collectAllNodeIds(this.filteredMentalArithmetic);
        }
      }
    });
  </script>
</body>

</html>